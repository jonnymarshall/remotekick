<%= render 'show__hero_section' %>
<%= render 'show__feature_bar' %>
<%= render 'show__lower_section' %>


BANNER SECTION
<div class="cover-image-container relative-element">
  <div class="cover-image-gradient absolute-element"></div>

  <% if @coffee_shop.cover_photo.present? %>
    <%= cl_image_tag @coffee_shop.cover_photo, :class => "cover-image absolute-element" %>
  <% elsif @coffee_shop.review_photos.first.present? %>
    <%= cl_image_tag @coffee_shop.review_photos.first.photo, :class => "cover-image absolute-element" %>
  <% else %>
    <%= image_tag ("petr-sevcovic-594807-unsplash.jpg"), :class => "cover-image absolute-element" %>
  <% end %>
  <div class="cover-image-text-container relative-element">
    <h1 class="light"><%= @coffee_shop.name %></h1>
    <h5 class="regular"><%= @coffee_shop.description %></h5>
    <h2>
      <% if @coffee_shop.rating.nil? %>
        No ratings yet.
      <% else %>
        <% (@coffee_shop.rating.round(0) + 1).times do %>
          <i class="fas fa-star"></i>
        <% end %>
      <% end %>
    </h2>
    <h6 class = "regular">Based on <%= @coffee_shop.reviews.count %> reviews.</h6>
  </div>
</div>

<!--INFO SECTION-->
<div class="container">

  <!--RATINGS SECTION-->
  <div class="d-flex justify-content-between padding-top-bottom">
    <div id="wifi-rating-block" class="d-inline-flex">
      <h3><i class="fa fa-wifi text-primary margin-right" aria-hidden="true"></i></h3>
      <div>
        <% unless @coffee_shop.download_speed.nil? %>
          <strong><%= @coffee_shop.download_speed.round(0) %> Mbps download speed</strong>
        <% else %>
          <strong>Upload speed unknown</strong>
        <% end %>
        <% unless @coffee_shop.upload_speed.nil? %>
          <p><%= @coffee_shop.upload_speed.round(0) %> Mbps upload speed: </p>
        <% else %>
          <p>Download speed unknown</p>
        <% end %>
        <% unless @coffee_shop.ping.nil? %>
          <p><%= @coffee_shop.ping.round(0) %> ms PING</p>
        <% else %>
          <p>PING unknown</p>
        <% end %>
      </div>
    </div>
    <div id="price-rating-block" class="align-self-center">
      <div class="d-flex justify-content-between">
        <% 3.times do %>
          <h3><i class="fas fa-dollar-sign"></i></h3>
        <% end %>
      </div>
      <div class="d-flex justify-content-around">
        <p>Price</p>
      </div>
    </div>
    <% unless @coffee_shop.plug_sockets.nil? %>
      <div id="plug-socket-rating-block" class="rating-block align-self-center">
        <div class="d-flex justify-content-between">
          <% (@coffee_shop.plug_sockets.round(0) + 1).times do %>
            <h3><i class="fas fa-smile text-primary"></i></h3>
          <% end %>
          <% (2 - @coffee_shop.plug_sockets.round(0)).times do %>
            <h3><i class="fas fa-smile dark-gray"></i></h3>
          <% end %>
        </div>
        <div class="d-flex justify-content-around">
          <p>Plug sockets</p>
        </div>
      </div>
    <% end %>
    <% unless @coffee_shop.comfort.nil? %>
      <div id="comfort-rating-block" class="rating-block align-self-center">
        <div class="d-flex justify-content-between">
          <% (@coffee_shop.comfort.round(0) + 1).times do %>
            <h3><i class="fas fa-smile text-primary"></i></h3>
          <% end %>
          <% (2 - @coffee_shop.comfort.round(0)).times do %>
            <h3><i class="fas fa-smile dark-gray"></i></h3>
          <% end %>
        </div>
        <div>
          <p class="d-flex justify-content-around">Comfort</p>
        </div>
      </div>
    <% end %>
    <% unless @coffee_shop.busyness.nil? %>
      <div id="busyness-rating-block" class="rating-block align-self-center">
        <div class="d-flex justify-content-between">
          <% (@coffee_shop.busyness.round(0) + 1).times do %>
            <h3><i class="fas fa-smile text-primary"></i></h3>
          <% end %>
          <% (2 - @coffee_shop.busyness.round(0)).times do %>
            <h3><i class="fas fa-smile dark-gray"></i></h3>
          <% end %>
        </div>
        <div>
          <p class="d-flex justify-content-around">Busyness</p>
        </div>
      </div>
    <% end %>
  </div>

  <!--DIVIDING LINE -->
  <div class="divider"></div>

  <!-- FEATURES SECTION-->
  <div class="row">
    <% if @coffee_shop.serves_food %>
      <div class="col">
        <p class="padding">Serves food</p>
      </div>
    <% end %>
  </div>

  <!--DIVIDING LINE (ONLY DISPLAY IF COFFEE SHOP FEATURES EXIST) -->
  <% if
    @coffee_shop.serves_food
    # ||
    # @coffee_shop.serves_plant_milk ||
    # @coffee_shop.serves_smoothies ||
    # @coffee_shop.air_conditioning
    %>
      <div class="divider"></div>
  <% end %>

    <!-- TOGGLES SECTION-->
  <div class="row">
    <div class="col-lg-2">
      <p class="padding">Reviews</p>
    </div>
    <div class="col-lg-2">
      <p class="padding">Photos</p>
    </div>
    <div class="col-lg-2">
      <p class="padding">Map</p>
    </div>
  </div>

  <!--DIVIDING LINE-->
  <div class="divider"></div>

  <!--CREATE A REVIEW BUTTON-->
  <div>
    <%= link_to new_coffee_shop_review_path(@coffee_shop) do %>
      <div class="btn btn-primary">Create a review</div>
    <% end %>
  </div>

  <!--REVIEWS SECTION-->
  <div class="d-flex flex-row wrap">
      <% @coffee_shop.reviews.order('updated_at DESC').each do |review| %>
        <div class="review">
          <div class="row no-gutters">
            <div class="col-3">
              <div class="avatar-review"></div>
            </div>
            <div class="col-9">
              <div>
                <p><strong><%= review.user.first_name %></strong></p>
                <% if ((Time.now - review.updated_at) / 1.day).round == 0 %>
                  <p>Today</p>
                <% elsif ((Time.now - review.updated_at) / 1.day).round == 1 %>
                  <p>Yesterday</p>
                <% else %>
                  <p><%= ((Time.now - review.updated_at) / 1.day).round %> days ago</p>
                <% end %>
                <p>
                  <% (review.rating + 1).times do %>
                    <i class="fas fa-star"></i>
                  <% end %>
                </p>
              </div>
            </div>
          </div>
          <div class="row no-gutters">
            <div class="col">
              <p class="bottom-padding"><%= review.content %></p>
            </div>
          </div>
          <div class="d-flex flex-row wrap">
            <% if review.review_photos.present? %>
              <% review.review_photos.each do |review_photo| %>
                <div>
                  <%= cl_image_tag review_photo.photo, class: "review-photo-thumbnail margin-bottom-md" %>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
  </div>
</div>
